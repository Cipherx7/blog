# Android Rooting Guide

> `e.g.` with a Google Pixel phone
>
> ðŸ”— [Pixel 6a](https://forum.xda-developers.com/f/google-pixel-6a.12605/)
>
> ðŸ”— [A13 detailed guide to Root & OTA's & pass SafetyNet / Play Integrity](https://forum.xda-developers.com/t/a13-detailed-guide-to-root-otas-pass-safetynet-play-integrity.4530221/)

## Introduction

This guide will walk you through the process of rooting your Google Pixel device using Magisk

---

## Prerequisites

Before we begin, make sure you have the following:

- A Google Pixel device (e.g., Pixel 6a).

### Android SDK Platform Tools

- Android SDK Platform Tools installed on your PC. You can install it using the following command:

```bash
sudo apt install -y android-sdk-platform-tools
```

### Developer Options / USB Debugging

- [Developer Options](https://developer.android.com/studio/debug/dev-options) enabled on your device. To do this:
  - Go to **Settings** > **About phone**.
  - Tap on the **Build number** several times to enable `Developer Options`.
  - Enter **System** > **Developer options**.
  - Set the following options:
    - Enable `OEM Unlocking`
    - Disable `Automatic system updates`
    - Enable `USB debugging`
    - Enable `Wireless debugging`
    - Enable `Disable adb authorization timeout`

---

## Unlock Bootloader (Google Devices)

1. Connect your device to your PC and authorize it. Reboot the device into bootloader mode using the following commands:

```bash
# Check for the connected device
adb devices

# Reboot to bootloader 
adb reboot bootloader
```

2. Wait for the Fastboot Mode screen to appear on your device and run the following command in the terminal:

```bash
fastboot flashing unlock
```

3. Use volume keys to select `Unlock the bootloader` option and confirm with the power button.
4. The `Device state` will change to `unlocked`.
5. Start the device and complete the initial setup.

---

## Rooting Android with Magisk

> - [Here's how you can unlock the bootloader and root the Google Pixel 6a with Magisk](https://www.xda-developers.com/how-to-unlock-bootloader-root-magisk-google-pixel-6a/)
> - [How to download Android 13 ](https://www.xda-developers.com/how-to-download-android-13/)

### Downloads

Before we begin, read the device OEM unlocking guide and make sure to download the necessary files:

1. **Magisk App** - Download the latest Magisk app version from the official repository on GitHub - [Magisk Latest Release](https://github.com/topjohnwu/Magisk/releases/latest)

2. **Factory Image for Your Device** - Download the factory image for your device, **based on the installed release**. You can find guidance on downloading Android 13 factory images here: [XDA Developers - How to Download Android 13 Factory Image](https://www.xda-developers.com/how-to-download-android-13/) 
   - **Be sure to select the `Unlocked` link for the installed version in the Factory column!**


### Enable USB Debugging

- Throughout this process, you may need to enable `USB debugging` mode on your device when needed, because this option will be disabled when the device is unlocked or new images are flashed.

### Installation

1. **Installing Magisk on Your Android Device**:

   - Connect your Android device to your computer.

   - Use the following `adb` command to install the Magisk APK on your device:

```bash
# Download magisk.apk latest version from GitHub
adb install magisk.apk
```

2. **Preparing the Boot Image**:
   - Extract the downloaded factory image on your computer.
   - Inside the extracted files, locate another zip file and extract it as well.
   - Look for the `boot.img` file within these extracted files.

3. **Copying Boot Image to Your Android Device**:

   - Open a Terminal into the `boot.img` folder

   - Use the following `adb` command to copy the `boot.img` file to your Android device with Magisk installed:

```bash
adb push boot.img /sdcard/Download/
```

4. **Patching the Boot Image**:

   - Open the Magisk app on your Android device.
   - In the app, tap `Install`, `Select and Patch a file` and proceed with patching the `boot.img` file you copied earlier in the `/sdcard/Download/` directory.

5. **Copying the Patched File Back to Your Computer**:

   - After patching, use the following `adb` command to copy the patched file from your device back to your computer:

```bash
adb pull /sdcard/Download/magisk_[random].img
```

### Rooting the Device

1. **Prepare Your Unlocked Device**:
   - Ensure that your Android device is unlocked.
   - Turn off the device.
2. **Boot into Fastboot Mode**:
   - Turn the device back on by holding down both the volume down and power buttons simultaneously. This should boot your device into fastboot mode.
   - or use the `adb` commands

```bash
adb reboot bootloader
```

3. **Connect to the Computer**:
   - Connect your Android device to your computer via USB.

4. **Boot Magisk Image**:

   - In the command prompt or terminal on your computer, run the following command:

```bash
fastboot flash boot magisk_[random].img

fastboot reboot
```

- Your device should now be booted with Magisk.

5. **Enable USB Debugging as Needed**:
   - Enter the **System** > `Developer options` screen
     - `OEM Unlocking` should be **Enabled and greyed out**
     - **Turn off** `Automatic system updates`
     - **Enable** `USB debugging`, `Wireless debugging`, `Disable adb authorization timeout`

6. **Confirm Root Access**:

   - After rebooting, you can confirm that your device is rooted by using the following ADB command:

```bash
adb shell
su
```

7. Complete device setup by connecting to WiFi.

---

## Magisk Modules

> **Notes**
>
> - The `Installed` status shows the version of patch in the boot image. If this says N/A, you do not have root access - the boot image is not patched, or you have a problem with Magisk.
> - `App` simply shows the version of the app itself.

---

## Other Settings

- When connecting to Wifi, change WiFi Privacy settings to `Use device MAC`
- Ask the sysadmin to configure a static DHCP Lease IP for the device based on the correct device MAC

---

